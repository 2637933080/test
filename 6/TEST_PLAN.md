# Checkout 微服务系统测试计划

## 1. 引言

### 1.1 目的
本文档旨在定义Checkout微服务的系统测试计划，确保服务能够按照预期处理结账请求并正确计算总金额。

### 1.2 范围
测试范围包括Checkout微服务的所有核心功能，特别是处理商品列表和计算总价的功能。

## 2. 测试策略

### 2.1 测试类型
我们将进行系统测试，重点是功能测试和API测试。

### 2.2 测试环境
- Python 3.11
- Flask框架
- pytest测试框架
- requests库用于HTTP请求

## 3. 测试场景

### 3.1 正常流程测试
验证服务能正确计算商品总价。

输入：
```json
{
  "items": [
    {
      "price": 20,
      "quantity": 3
    }
  ]
}
```

期望输出：
- 状态码：200
- 响应体：
```json
{
  "total": 60,
  "status": "ok"
}
```

### 3.2 边界条件测试
测试多个商品的计算。

输入：
```json
{
  "items": [
    {
      "price": 10,
      "quantity": 2
    },
    {
      "price": 15,
      "quantity": 1
    }
  ]
}
```

期望输出：
- 状态码：200
- 响应体：
```json
{
  "total": 35,
  "status": "ok"
}
```

### 3.3 错误处理测试
测试空购物车的情况。

输入：
```json
{
  "items": []
}
```

期望输出：
- 状态码：400
- 响应体：
```json
{
  "error": "empty cart"
}
```

## 4. 测试用例

| 用例ID | 测试描述 | 输入数据 | 期望结果 |
|--------|---------|---------|---------|
| TC001 | 单个商品总价计算 | 1个价格为20、数量为3的商品 | 返回总价60，状态码200 |
| TC002 | 多个商品总价计算 | 2个商品(价格10数量2和价格15数量1) | 返回总价35，状态码200 |
| TC003 | 空购物车处理 | 空items数组 | 返回错误信息，状态码400 |

## 5. 自动化测试脚本

自动化测试脚本使用Python编写，利用pytest框架和requests库来测试服务。

## 6. 测试执行

使用以下命令运行测试：
```
pytest
```

生成HTML格式的测试报告：
```
pytest --html=report.html --self-contained-html
```

## 7. CI/CD集成

通过GitHub Actions实现持续集成，在每次代码推送时自动运行测试。